/* empty css                *//* empty css                    *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                     */import{r as f}from"./request-d9b764dc.js";import{a as x,o as n,c as w,h as b,d as s,w as r,i as u,B as z,C as V,D,G as B,I as d,f as i,E as c,J as I,K as U,N as O,O as $}from"./index-3f6e6985.js";const M={class:"card",style:{"margin-bottom":"5px"}},P={class:"card",style:{"margin-bottom":"5px"}},T={key:0,class:"card"},Q={__name:"Orders",setup(R){const e=x({user:JSON.parse(localStorage.getItem("system-user")||"{}"),pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},tableData:[],order_no:null}),m=()=>{e.user.role==="USER"?f.get("/orders/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,order_no:e.order_no,user_id:e.user.id}}).then(l=>{var a,o;e.tableData=(a=l.data)==null?void 0:a.list,e.total=(o=l.data)==null?void 0:o.total}):f.get("/orders/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,order_no:e.order_no}}).then(l=>{var a,o;e.tableData=(a=l.data)==null?void 0:a.list,e.total=(o=l.data)==null?void 0:o.total})},y=(l,a)=>{l.status=a,console.log(l),console.log(e.form),f.put("/orders/update",l).then(o=>{o.code==="200"?(m(),c.success("操作成功"),e.formVisible=!1):c.error(o.msg)})},C=l=>{I.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(a=>{f.delete("/orders/delete/"+l).then(o=>{o.code==="200"?(m(),c.success("操作成功")):c.error(o.msg)})}).catch(a=>{})},h=(l,a)=>{f.get("/goods/cancelOrder",{params:{goods_id:l,num:a}}).then(o=>{o.code==="200"?(m(),c.success("操作成功"),e.formVisible=!1):(console.log(o),c.error(o.msg))})},N=()=>{e.order_no=null,m()};return m(),(l,a)=>{const o=z,g=V,p=U,v=O,_=$,E=D,S=B;return n(),w("div",null,[b("div",M,[s(o,{modelValue:e.order_no,"onUpdate:modelValue":a[0]||(a[0]=t=>e.order_no=t),style:{width:"300px","margin-right":"10px"},placeholder:"请输入订单编号查询"},null,8,["modelValue"]),s(g,{type:"primary",onClick:m},{default:r(()=>[d("查询")]),_:1}),s(g,{type:"info",style:{margin:"0 10px"},onClick:N},{default:r(()=>[d("重置")]),_:1})]),b("div",P,[s(E,{data:e.tableData,stripe:""},{default:r(()=>[s(p,{label:"订单编号",prop:"order_no"}),s(p,{label:"商品名称",prop:"goods_name"}),s(p,{label:"商品图片",prop:"goods_img"},{default:r(t=>[s(v,{style:{"border-radius":"5%","max-width":"50px"},src:t.row.goods_img,"preview-src-list":[t.row.goods_img],"preview-teleported":!0},null,8,["src","preview-src-list"])]),_:1}),s(p,{label:"购买数量",prop:"num"}),s(p,{label:"下单人",prop:"user_name"}),s(p,{label:"订单状态",prop:"status"},{default:r(t=>[t.row.status==="待支付"?(n(),i(_,{key:0,type:"warning"},{default:r(()=>[d("待支付")]),_:1})):u("",!0),t.row.status==="待发货"?(n(),i(_,{key:1,type:"success"},{default:r(()=>[d("待发货")]),_:1})):u("",!0),t.row.status==="待收货"?(n(),i(_,{key:2,type:"info"},{default:r(()=>[d("待收货")]),_:1})):u("",!0),t.row.status==="已收货"?(n(),i(_,{key:3,type:"success"},{default:r(()=>[d("已收货")]),_:1})):u("",!0),t.row.status==="已取消"?(n(),i(_,{key:4,type:"danger"},{default:r(()=>[d("已取消")]),_:1})):u("",!0)]),_:1}),s(p,{label:"下单时间",prop:"time"}),s(p,{label:"操作","header-align":"center",width:"160"},{default:r(t=>[t.row.status==="待支付"?(n(),i(g,{key:0,type:"danger",onClick:k=>(y(t.row,"已取消"),h(t.row.goods_id,t.row.num))},{default:r(()=>[d("取消")]),_:2},1032,["onClick"])):u("",!0),e.user.role==="USER"&&t.row.status==="待支付"?(n(),i(g,{key:1,type:"danger",onClick:k=>y(t.row,"待发货")},{default:r(()=>[d("支付")]),_:2},1032,["onClick"])):u("",!0),e.user.role==="ADMIN"&&t.row.status==="待发货"?(n(),i(g,{key:2,type:"danger",onClick:k=>y(t.row,"待收货")},{default:r(()=>[d("发货")]),_:2},1032,["onClick"])):u("",!0),e.user.role==="USER"&&t.row.status==="待收货"?(n(),i(g,{key:3,type:"danger",onClick:k=>y(t.row,"已收货")},{default:r(()=>[d("收货")]),_:2},1032,["onClick"])):u("",!0),e.user.role==="ADMIN"?(n(),i(g,{key:4,type:"danger",onClick:k=>C(t.row.id)},{default:r(()=>[d("删除")]),_:2},1032,["onClick"])):u("",!0)]),_:1})]),_:1},8,["data"])]),e.total?(n(),w("div",T,[s(S,{background:"",layout:"prev, pager, next","page-size":e.pageSize,"onUpdate:pageSize":a[1]||(a[1]=t=>e.pageSize=t),"current-page":e.pageNum,"onUpdate:currentPage":a[2]||(a[2]=t=>e.pageNum=t),total:e.total},null,8,["page-size","current-page","total"])])):u("",!0)])}}};export{Q as default};
