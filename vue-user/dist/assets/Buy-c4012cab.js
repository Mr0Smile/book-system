/* empty css                *//* empty css               *//* empty css               *//* empty css               */import{r as y}from"./request-9dc1f99e.js";import{c as L,e as a,i as d,h as s,g as p,w as i,F as v,j as k,f as u,l as S,J as B,K as U,L as P,M as $,N as r,t as c,E as h,O as F,P as I,Q as T,R as D}from"./index-c150de53.js";const J={class:"card",style:{"margin-bottom":"10px"}},M={style:{"margin-bottom":"10px"}},O={class:"card"},R=["src"],j={style:{"font-size":"18px",margin:"5px 0"},color:"#333"},q={key:0,style:{"font-size":"14px",margin:"5px 0"},color:"#666 min-height: 20px;",class:"line1"},A={key:1,style:{"font-size":"14px",margin:"5px 0"},color:"#666 min-height: 20px;"},K={style:{margin:"5px 0",display:"flex","align-items":"center"}},Q={style:{flex:"1"}},G={style:{color:"red","font-size":"18px"}},H={style:{flex:"1"}},W={style:{"text-align":"right"}},X={style:{"margin-right":"20px",display:"inline-block","min-width":"40px",color:"red"}},Y={key:1,style:{"text-align":"center",padding:"50px 0",color:"#888"}},Z=s("h2",null,"没有找到相关商品",-1),tt=[Z],et={key:2,style:{"margin-top":"10px"}},ct={__name:"Buy",setup(ot){const e=L({user:JSON.parse(localStorage.getItem("system-user")||"{}"),categoryList:[],pageNum:1,pageSize:10,total:0,goodsList:[],activeCategory:null});y.get("/category/selectAll").then(o=>{e.categoryList=o.data});const m=()=>{y.get("/goods/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,category_id:e.activeCategory}}).then(o=>{var n,l;e.goodsList=(n=o.data)==null?void 0:n.list,e.total=(l=o.data)==null?void 0:l.total,e.goodsList.forEach(g=>{g.num=0,g.total=0})})},C=o=>{o.total=(o.num*o.price).toFixed(2)},z=o=>{let n={goods_id:o.id,num:o.num,user_id:e.user.id};n.num==0?h.error("购买数量不能为0"):y.post("/orders/add",n).then(l=>{l.code==="200"?(h.success("下单成功"),o.num=0,o.total=0):h.error(l.msg)})},x=o=>{e.activeCategory=o,m()};return m(),(o,n)=>{const l=B,g=U,N=F,f=I,E=T,V=D,b=P,w=$;return a(),d("div",null,[s("div",J,[p(l,{onClick:n[0]||(n[0]=t=>x(null))},{default:i(()=>[r("全部")]),_:1}),(a(!0),d(v,null,k(e.categoryList,t=>(a(),u(l,{key:t.id,onClick:_=>x(t.id)},{default:i(()=>[r(c(t.category),1)]),_:2},1032,["onClick"]))),128))]),s("div",M,[p(g,{modelValue:e.name,"onUpdate:modelValue":n[1]||(n[1]=t=>e.name=t),placeholder:"请输入商品名称",size:"large",style:{width:"300px"}},null,8,["modelValue"]),p(l,{type:"primary",onClick:m},{default:i(()=>[r("查询")]),_:1})]),e.total>0?(a(),u(b,{key:0,gutter:10},{default:i(()=>[(a(!0),d(v,null,k(e.goodsList,t=>(a(),u(V,{span:6,key:t.id},{default:i(()=>[s("div",O,[s("img",{src:t.img,alt:"",style:{width:"100%",height:"280px"}},null,8,R),s("div",j,c(t.name),1),p(N,{content:t.descr,placement:"bottom",effect:"light"},{default:i(()=>[t.descr!=null?(a(),d("div",q,c(t.descr),1)):(a(),d("div",A,"暂无简介"))]),_:2},1032,["content"]),s("div",null,[t.specials!=null?(a(),u(f,{key:0,type:"success",style:{"margin-right":"5px"}},{default:i(()=>[r(c(t.specials),1)]),_:2},1024)):(a(),u(f,{key:1,type:"success",style:{"margin-right":"5px"}},{default:i(()=>[r("暂无标签")]),_:1}))]),s("div",K,[s("div",Q,[s("strong",G,"¥"+c(t.price),1),r("/"+c(t.unit),1)]),s("div",H," 库存："+c(t.stock),1),s("div",null,[p(E,{min:0,max:t.stock,modelValue:t.num,"onUpdate:modelValue":_=>t.num=_,style:{width:"100px"},onChange:_=>C(t)},null,8,["max","modelValue","onUpdate:modelValue","onChange"])])]),s("div",W,[r(" 总价："),s("strong",X,"¥"+c(t.total),1),p(l,{style:{margin:"0 5px"},type:"primary",size:"small",onClick:_=>z(t)},{default:i(()=>[r("购买")]),_:2},1032,["onClick"])])])]),_:2},1024))),128))]),_:1})):(a(),d("div",Y,tt)),e.total?(a(),d("div",et,[p(w,{background:"",layout:"prev, pager, next","page-size":e.pageSize,"onUpdate:pageSize":n[2]||(n[2]=t=>e.pageSize=t),"current-page":e.pageNum,"onUpdate:currentPage":n[3]||(n[3]=t=>e.pageNum=t),total:e.total},null,8,["page-size","current-page","total"])])):S("",!0)])}}};export{ct as default};
